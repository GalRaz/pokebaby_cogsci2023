
```{r eval=FALSE, include=FALSE}
# FAILED TO CONVERGE
#preschool_general_mod <- lmer(trial_looking_time ~ age_in_months * trial_number * trial_type + (trial_number * trial_type | subject), control = lmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 100000)),data = preschool_d)

preschool_general_mod <- lmer(log(trial_looking_time) ~ age_in_months * trial_number * trial_type + (1 | subject), control = lmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 100000)),data = preschool_d)

preschool_posthoc_mod <- lmer(log(trial_looking_time) ~  trial_number * trial_type + (1 | subject), control = lmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 100000)),data = preschool_d)


# look at familiarity preference 
fam_test_df <- preschool_d %>% filter(trial_number == 2)
fam_mod <-lmer(log(trial_looking_time) ~  trial_type + (1 | subject), control = lmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 100000)),
     data = fam_test_df)

saveRDS(preschool_general_mod, here("cached_data/preschooler/preschool_general_mod.Rds"))
saveRDS(preschool_posthoc_mod, here("cached_data/preschooler/preschool_posthoc_mod.Rds"))
saveRDS(fam_mod, here("cached_data/preschooler/fam_mod.Rds"))

```



```{r}


summary_preschool_mod_df <- broom.mixed::tidy(preschool_general_mod) %>% mutate_if(is.numeric, round, 2)
fam_mod_df <- broom.mixed::tidy(fam_mod)

```


We anticipated that the preschooler children would show patterns of habituation and dishabituation similar to adults. We also expected to see developmental changes in the shape of habituation trajectories. Our pre-registered mixed-effect mod includes a three-way interaction term between age (in months), trial number, and trial type (background or deviant) to predict log-transformed looking time. We only found a main effect of trial number, suggesting that participants look shorter at latter trials ($\beta$ = `r filter(summary_preschool_mod_df, term == "trial_number")$estimate`, *SE* = `r filter(summary_preschool_mod_df, term == "trial_number")$std.error`, *t* = `r filter(summary_preschool_mod_df, term == "trial_number")$statistic`, *p* = `r filter(summary_preschool_mod_df, term == "trial_number")$p.value`). Since there was no reliable age effect, we deviated from the analysis plan and ran a mixed-effect model only including two-way interaction between trial number and trial type. In this model, all predictors were significant (all *p* < 0.01), suggesting our paradigms successfully captured habituation and dishabituation in preschoolers. 

We also explored the potential familiarity preference by comparing the looking time at the second background trial and the second deviant trial. Under the Hunter & Ames (1988), the second trial in each block is most likely to yield a familiarity preference, since participants receive the least amount of familiarization with the background stimulus in a block. If there is a familiarity preference, participants should look longer at a background trial than a deviant trial. However, we did not find evidence supporting this prediction. We ran a mixed effect model predicting looking time at the second trial with trial type as the predictor. There was a significant trial type effect in the opposite direction, suggesting participants looked longer at the deviant trial than the background trial even with as little as one trial of familiarization time ($\beta$ = `r round(filter(fam_mod_df, term == "trial_typedeviant")$estimate, 2)`, *SE* = `r round(filter(fam_mod_df, term == "trial_typedeviant")$std.error, 2)`, *t* = `r round(filter(fam_mod_df, term == "trial_typedeviant")$statistic, 2)`, *p* < 0.01).  

In summary, This current experiment replicated the finding in  We captured habituation and dishabituation with a developmental sample. More importantly, under the current paradigm, we did not find any evidence of familiarity preference for this younger age group. We moved to the infant samples in the next experiment.
